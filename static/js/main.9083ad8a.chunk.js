(this["webpackJsonppicture-bed"]=this["webpackJsonppicture-bed"]||[]).push([[0],{152:function(e,t,n){},237:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),i=n(31),s=n.n(i),a=(n(152),n(153),n(56)),o=n(28),l=n(11),u=n(12),j=n(9),b=n(49),d=n.n(b);d.a.init({appId:"yA44ngzWUm5AGxTcizJxRMcG-gzGzoHsz",appKey:"miDj0W9Kl7YtXMyWTTDhGqGx",serverURL:"https://ya44ngzw.lc-cn-n1-shared.com"});var h,f,x,O=function(e,t){var n=new b.User;return n.setUsername(e),n.setPassword(t),new Promise((function(e,t){n.signUp().then((function(t){e(t)})).catch((function(e){t(e)}))}))},g=function(e,t){return new Promise((function(n,r){b.User.logIn(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))},p=function(){b.User.logOut()},m=function(){return b.User.current()},v=function(e,t){var n=new d.a.Object("Image"),r=new d.a.File(t,e);return n.set("filename",t),n.set("owner",b.User.current()),n.set("url",r),new Promise((function(e,t){n.save().then((function(t){e(t)})).catch((function(e){t(e)}))}))},w=function(e){var t=e.page,n=void 0===t?0:t,r=e.limit,c=void 0===r?10:r,i=new d.a.Query("Image");return i.include("owner"),i.include("createAt"),i.limit(c),i.skip(n*c),i.descending("createdAt"),i.equalTo("owner",b.User.current()),new Promise((function(e,t){i.find().then((function(t){e(t)})).catch((function(e){t(e)}))}))},U=new(function(){function e(){Object(l.a)(this,e),this.currentUser=null,Object(j.m)(this,{currentUser:j.n,setCurrentUser:j.f,resetCurrentUser:j.f})}return Object(u.a)(e,[{key:"setCurrentUser",value:function(){this.currentUser=m()}},{key:"resetCurrentUser",value:function(){this.currentUser=null}}]),e}()),y=new(function(){function e(){Object(l.a)(this,e),this.values={username:"",password:""},Object(j.m)(this,{values:j.n,setUsername:j.f,setPassword:j.f,login:j.f,register:j.f,logout:j.f})}return Object(u.a)(e,[{key:"setUsername",value:function(e){this.values.username=e}},{key:"setPassword",value:function(e){this.values.password=e}},{key:"login",value:function(){var e=this;return new Promise((function(t,n){g(e.values.username,e.values.password).then((function(e){U.setCurrentUser(),t(e)})).catch((function(e){U.resetCurrentUser(),n(e)}))}))}},{key:"register",value:function(){var e=this;return new Promise((function(t,n){O(e.values.username,e.values.password).then((function(e){U.setCurrentUser(),t(e)})).catch((function(e){U.resetCurrentUser(),n(e)}))}))}},{key:"logout",value:function(){p(),U.resetCurrentUser()}}]),e}()),F=new(function(){function e(){Object(l.a)(this,e),this.filename="",this.file=null,this.isUploading=!1,this.serverFile=null,Object(j.m)(this,{filename:j.n,file:j.n,isUploading:j.n,serverFile:j.n,setFile:j.f,setFilename:j.f,upload:j.f})}return Object(u.a)(e,[{key:"setFilename",value:function(e){this.filename=e}},{key:"setFile",value:function(e){this.file=e}},{key:"upload",value:function(){var e=this;return this.isUploading=!0,this.serverFile=null,new Promise((function(t,n){v(e.file,e.filename).then((function(n){e.serverFile=n,t(n)})).catch((function(e){n(e)})).finally((function(){e.isUploading=!1}))}))}}]),e}()),k=Object(r.createContext)({AuthStore:y,UserStore:U,ImageStore:F}),C=function(){return Object(r.useContext)(k)},S=n(36),P=n(37),I=n.p+"static/media/burt.37709180.png",z=n(81),L=n(35),A=n(6),T=P.a.header(h||(h=Object(S.a)(["\n  display: flex;\n  align-items: center;\n  padding: 10px 100px;\n  background-color: #407fbf;\n  color: #fff;\n  @media (max-width: 768px) {\n    padding: 10px 10px;\n    > img {display: none;}\n  }\n  > img {height: 30px;}\n  > nav {\n    > a {\n      color: #fff;\n      margin-left: 30px;\n      &.active{border-bottom: solid 1px #fff;}\n    }\n  }\n"]))),M=P.a.div(f||(f=Object(S.a)(["\n  margin-left: auto;\n  > button:first-child{margin-right: 20px;}\n  > span {\n    margin-right: 20px;\n    color: #cccccc;\n  }\n"]))),E=Object(L.a)((function(){var e=C(),t=e.UserStore,n=e.AuthStore,r=Object(o.f)();return Object(A.jsxs)(T,{children:[Object(A.jsx)("img",{src:I,alt:""}),Object(A.jsxs)(a.a,{children:[Object(A.jsxs)("nav",{children:[Object(A.jsx)(a.b,{to:"/",activeClassName:"active",exact:!0,children:"\u9996\u9875"}),Object(A.jsx)(a.b,{to:"/history",activeClassName:"active",children:"\u4e0a\u4f20\u8bb0\u5f55"}),Object(A.jsx)(a.b,{to:"/about",activeClassName:"active",children:"\u5173\u4e8e"})]}),Object(A.jsx)(M,{children:t.currentUser?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("span",{children:["hello, ",t.currentUser.attributes.username]}),Object(A.jsx)(z.a,{size:"small",onClick:function(){n.logout(),r.push("/login")},children:"\u6ce8\u9500"})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(z.a,{size:"small",children:Object(A.jsx)(a.b,{to:"/login",children:"\u767b\u5f55"})}),Object(A.jsx)(z.a,{size:"small",children:Object(A.jsx)(a.b,{to:"/register",children:"\u6ce8\u518c"})})]})})]})]})})),N=P.a.footer(x||(x=Object(S.a)(["\n  padding: 10px 100px;\n  text-align: center;\n  font-size: 12px;\n  color: #aaa;\n"])));var B,q,G,R=function(){return Object(A.jsx)(N,{children:"\xa9 2022 Burt. All rights reserved."})},$=function(e){return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(E,{}),Object(A.jsx)("main",{children:e.children}),Object(A.jsx)(R,{})]})},D=n(3),J=n(5),W=n(239),V=n(143),_=n(138),H=n(243),K=W.a.Dragger,Q=P.a.div(B||(B=Object(S.a)(["\n  border: 1px #ccc dashed;\n  margin-top: 30px;\n  padding: 20px;\n\n  img {\n    max-width: 300px;\n  }\n"]))),X=P.a.dd(q||(q=Object(S.a)(["\n  color: deepskyblue;\n"]))),Y=Object(L.a)((function(){var e=C(),t=e.ImageStore,n=e.UserStore,c=Object(r.useRef)(),i=Object(r.useRef)(),s=Object(r.useState)("300"),a=Object(J.a)(s,2),o=a[0],l=a[1],u=Object(r.useState)("300"),j=Object(J.a)(u,2),b=j[0],d=j[1],h={showUploadList:!1,beforeUpload:function(e){return n.currentUser?/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/gi.test(e.type)?e.size>1048576?(V.b.warning("\u56fe\u7247\u5c3a\u5bf8\u6700\u5927\u4e3a 1M"),!1):(t.setFile(e),t.setFilename(e.name),t.upload().then((function(e){V.b.success("\u4e0a\u4f20\u6210\u529f"),console.log(e)})).catch((function(){V.b.error("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")})),!1):(V.b.warning("\u4e0a\u4f20\u7684\u56fe\u7247\u683c\u5f0f\u4e0d\u6b63\u786e"),!1):(V.b.warning("\u8bf7\u5148\u767b\u5f55\u518d\u4e0a\u4f20"),!1)}};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(_.a,{spinning:t.isUploading,tip:"\u4e0a\u4f20\u4e2d...",children:Object(A.jsxs)(K,Object(D.a)(Object(D.a)({},h),{},{children:[Object(A.jsx)("p",{className:"ant-upload-drag-icon",children:Object(A.jsx)(H.a,{})}),Object(A.jsx)("p",{className:"ant-upload-text",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u4e0a\u4f20\u56fe\u7247"}),Object(A.jsx)("p",{className:"ant-upload-hint",children:"\u4ec5\u652f\u6301.png/.gif/.svg/.jpg\u683c\u5f0f\u7684\u56fe\u7247\uff0c\u56fe\u7247\u6700\u5927\u5c3a\u5bf8\u4e3a 1M"})]}))}),t.serverFile&&n.currentUser?Object(A.jsxs)(Q,{children:[Object(A.jsx)("h1",{children:"\u4e0a\u4f20\u7ed3\u679c"}),Object(A.jsxs)("dl",{children:[Object(A.jsx)("dt",{children:"\u7ebf\u4e0a\u5730\u5740"}),Object(A.jsx)("dd",{children:Object(A.jsx)("a",{href:t.serverFile.attributes.url.attributes.url,target:"_blank",rel:"noreferrer",style:{wordBreak:"break-word"},children:t.serverFile.attributes.url.attributes.url})}),Object(A.jsx)("dt",{children:"\u6587\u4ef6\u540d"}),Object(A.jsx)(X,{children:t.filename}),Object(A.jsx)("dt",{children:"\u56fe\u7247\u9884\u89c8"}),Object(A.jsx)("dd",{children:Object(A.jsx)("img",{src:t.serverFile.attributes.url.attributes.url,alt:""})}),Object(A.jsx)("dt",{children:"\u66f4\u591a\u5c3a\u5bf8"}),Object(A.jsxs)("dd",{children:[Object(A.jsx)("input",{ref:c,onChange:function(){l(c.current.value||"300")},placeholder:"\u6700\u5927\u5bbd\u5ea6\uff08\u53ef\u9009\uff09"}),Object(A.jsx)("input",{ref:i,onChange:function(){d(i.current.value||"300")},placeholder:"\u6700\u5927\u9ad8\u5ea6\uff08\u53ef\u9009\uff09"})]}),Object(A.jsx)("dd",{children:Object(A.jsx)("a",{href:"".concat(t.serverFile.attributes.url.attributes.url,"?imageView2/0/w/").concat(o,"/h/").concat(b),target:"_blank",rel:"noreferrer",style:{wordBreak:"break-word"},children:"".concat(t.serverFile.attributes.url.attributes.url,"?imageView2/0/w/").concat(o,"/h/").concat(b)})})]})]}):null]})})),Z=P.a.div(G||(G=Object(S.a)(["\n  background: orange;\n  padding: 10px;\n  margin: 0 0 30px;\n  color: #fff;\n  border-radius: 4px;\n  text-align: center;\n"]))),ee=Object(L.a)((function(e){var t=C().UserStore;return Object(A.jsx)(A.Fragment,{children:t.currentUser?null:Object(A.jsx)(Z,{children:e.children})})}));var te,ne=function(){return Object(A.jsxs)($,{children:[Object(A.jsx)(ee,{children:"\u8bf7\u5148\u767b\u5f55\u518d\u4e0a\u4f20\uff01"}),Object(A.jsx)(Y,{})]})},re=n(7),ce=n(240),ie=P.a.img(te||(te=Object(S.a)(["\n  width: 120px;\n  height: 80px;\n  object-fit: contain;\n  border: solid 1px #ccc;\n"]))),se=Object(L.a)((function(){var e=C().UserStore,t=Object(r.useState)(!1),n=Object(J.a)(t,2),c=n[0],i=n[1],s=Object(r.useState)([]),a=Object(J.a)(s,2),o=a[0],l=a[1],u=Object(r.useState)(!0),j=Object(J.a)(u,2),b=j[0],d=j[1],h=Object(r.useState)(0),f=Object(J.a)(h,2),x=f[0],O=f[1],g=function(t){("false"!==localStorage.getItem("isLogin")||e.currentUser)&&(i(!0),w({page:t,limit:10}).then((function(e){console.log(e),0===e.length&&d(!1),l([].concat(Object(re.a)(o),Object(re.a)(e)))})).finally((function(){i(!1)})))};Object(r.useEffect)((function(){l([]),g(x)}),[]);var p=b&&e.currentUser?Object(A.jsx)("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:Object(A.jsx)(z.a,{onClick:function(){g(x+1),O(x+1)},children:"loading more"})}):null;return Object(A.jsx)($,{children:Object(A.jsx)("div",{children:Object(A.jsx)("div",{children:Object(A.jsx)(ce.b,{loading:c,itemLayout:"horizontal",loadMore:p,dataSource:o,renderItem:function(e){return Object(A.jsxs)(ce.b.Item,{children:[Object(A.jsx)("div",{children:Object(A.jsx)(ie,{src:e.attributes.url.attributes.url,alt:""})}),Object(A.jsx)("div",{children:e.attributes.filename}),Object(A.jsx)("div",{children:Object(A.jsx)("a",{href:e.attributes.url.attributes.url,target:"_blank",rel:"noreferrer",style:{wordBreak:"break-word"},children:e.attributes.url.attributes.url})})]},e.id)}})})})})}));var ae,oe=function(){return Object(A.jsx)($,{children:Object(A.jsx)("div",{children:"\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8e React + Typescript \u7684\u56fe\u5e8a\u5e94\u7528\u3002"})})},le=n(241),ue=n(242),je=P.a.div(ae||(ae=Object(S.a)(["\n  padding: 20px;\n  margin: 50px 500px 0;\n  min-width: 500px;\n  border: solid 1px #ccc;\n\n  @media (max-width: 768px) {\n    margin: 50px auto 0;\n    min-width: 200px;\n  }\n\n  &:hover{\n    box-shadow: 0 5px 19px 6px rgba(0,0,0,0.05);\n    border: none;\n  }\n  >span{\n    display: block;\n    text-align: center;\n    font-size: 1.5em;\n    padding-bottom: 0.5em;\n    font-weight: 500;\n  }\n"]))),be={labelCol:{span:4},wrapperCol:{span:20}},de={wrapperCol:{offset:4,span:20}},he=Object(L.a)((function(e){var t=e.isLogin,n=le.a.useForm(),r=Object(J.a)(n,1)[0],c=C().AuthStore,i=Object(o.f)(),s=function(e){c.setUsername(e.username),c.setPassword(e.password)};return Object(A.jsxs)(je,{children:[Object(A.jsx)("span",{children:t?"\u56fe\u5e8a\u7cfb\u7edf\u767b\u5f55":"\u6b22\u8fce\u6ce8\u518c\u56fe\u5e8a\u7cfb\u7edf"}),Object(A.jsxs)(le.a,Object(D.a)(Object(D.a)({form:r},be),{},{labelAlign:"left",name:"basic",onFinish:function(e){console.log("Success:",e),t?function(e){s(e),c.login().then((function(){V.b.success("\u767b\u5f55\u6210\u529f"),i.push("/")})).catch((function(e){V.b.error(e.rawMessage)}))}(e):function(e){s(e),c.register().then((function(){V.b.success("\u6ce8\u518c\u6210\u529f\uff0c\u5e76\u6210\u529f\u767b\u5f55"),i.push("/")})).catch((function(e){V.b.error(e.rawMessage)}))}(e)},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(A.jsx)(le.a.Item,{label:"\u7528\u6237\u540d",name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{validator:function(e,t){return/\W/.test(t)?Promise.reject(new Error("\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf")):t.length<4||t.length>10?Promise.reject(new Error("\u957f\u5ea6\u4e3a4~10\u4e2a\u5b57\u7b26")):Promise.resolve()}}],children:Object(A.jsx)(ue.a,{})}),Object(A.jsx)(le.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}],children:Object(A.jsx)(ue.a.Password,{})}),!t&&Object(A.jsx)(le.a.Item,{label:"\u786e\u8ba4\u5bc6\u7801",name:"confirmPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801"},{validator:function(e,t){return r.getFieldValue("password")===t?Promise.resolve():Promise.reject(new Error("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4"))}}],children:Object(A.jsx)(ue.a.Password,{})}),Object(A.jsx)(le.a.Item,Object(D.a)(Object(D.a)({},de),{},{children:Object(A.jsx)(z.a,{type:"primary",htmlType:"submit",children:t?"\u767b\u5f55":"\u6ce8\u518c"})}))]}))]})})),fe=Object(L.a)((function(){return Object(A.jsx)($,{children:Object(A.jsx)(he,{isLogin:!0})})})),xe=Object(L.a)((function(){return Object(A.jsx)($,{children:Object(A.jsx)(he,{isLogin:!1})})}));var Oe=function(){var e=C().UserStore;return c.a.useEffect((function(){JSON.parse(localStorage.getItem("isLogin")||"false")?e.setCurrentUser():e.resetCurrentUser(),e.setCurrentUser(),window.addEventListener("beforeunload",(function(t){e.currentUser?localStorage.setItem("isLogin","true"):localStorage.setItem("isLogin","false")}))}),[]),Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(a.a,{children:Object(A.jsxs)(o.c,{children:[Object(A.jsx)(o.a,{path:"/",component:ne,exact:!0}),Object(A.jsx)(o.a,{path:"/history",component:se,exact:!0}),Object(A.jsx)(o.a,{path:"/about",component:oe,exact:!0}),Object(A.jsx)(o.a,{path:"/login",component:fe,exact:!0}),Object(A.jsx)(o.a,{path:"/register",component:xe,exact:!0})]})})})},ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,244)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),i(e),s(e)}))};s.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(Oe,{})}),document.getElementById("root")),ge()}},[[237,1,2]]]);
//# sourceMappingURL=main.9083ad8a.chunk.js.map